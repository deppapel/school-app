<h2>Results</h2>

<table border="1" style="border-collapse: collapse; width: 100%;">
    <tr>
        <th>Adm No</th>
        <th>Student Name</th>
        {% for subject in subjects %}
            <th>{{ subject.subject_name }}</th>
        {% endfor %}
        <th>Total Marks</th>
        <th>Total Points</th>
        <th>Grade</th>
    </tr>

    {% for student in students %}
    {% set ns = namespace(total_marks=0, total_points=0) %}
    <tr>
        <td>{{ student.adm_no }}</td>
        <td>{{ student.first_name }} {{ student.second_name }}</td>

        {% for subject in subjects %}
            <td>
                {% set found = false %}
                {% for result in student.results %}
                    {% if result.subject_id == subject.id %}
                        {{ result.marks }} ({{ result.grade }})
                        {% set ns.total_marks = ns.total_marks + result.marks %}
                        {% set ns.total_points = ns.total_points + result.points %}
                        {% set found = true %}
                    {% endif %}
                {% endfor %}
                {% if not found %}-{% endif %}
            </td>
        {% endfor %}

        <td>{{ ns.total_marks }}</td>
        <td>{{ ns.total_points }}</td>
        <td>
            {% if ns.total_points >= 70 %}A
            {% elif ns.total_points >= 60 %}B
            {% elif ns.total_points >= 50 %}C
            {% elif ns.total_points >= 40 %}D
            {% else %}E
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>




