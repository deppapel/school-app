<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Results Analysis</title>
    <style>
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f4f4f4; }
        .student-name { text-align: left; font-weight: bold; }
        .summary-cell { background-color: #fafafa; font-weight: bold; }
    </style>
</head>
<body>

    <h2>Academic Performance Report</h2>

    <table>
        <thead>
            <tr>
                <th rowspan="2">Student Name</th>
                <th colspan="{{ compulsory_subjects|length }}">Compulsory</th>
                <th colspan="{{ arts_subjects|length }}">Arts</th>
                <th colspan="{{ applied_subjects|length }}">Applied</th>
                <th colspan="3">Summary</th>
            </tr>
            <tr>
                {% for sub in compulsory_subjects %} <th>{{ sub.name }}</th> {% endfor %}
                {% for sub in arts_subjects %} <th>{{ sub.name }}</th> {% endfor %}
                {% for sub in applied_subjects %} <th>{{ sub.name }}</th> {% endfor %}
                
                <th>Total Pts</th>
                <th>Count</th>
                <th>Grade</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in student_data %}
            <tr>
                <td class="student-name">{{ entry.student.name }}</td>

                {# 1. Compulsory Subjects #}
                {% for sub in compulsory_subjects %}
                    <td>{{ entry.results_dict[sub.id].grade if sub.id in entry.results_dict else '-' }}</td>
                {% endfor %}

                {# 2. Arts Subjects #}
                {% for sub in arts_subjects %}
                    <td>{{ entry.results_dict[sub.id].grade if sub.id in entry.results_dict else '-' }}</td>
                {% endfor %}

                {# 3. Applied Subjects #}
                {% for sub in applied_subjects %}
                    <td>{{ entry.results_dict[sub.id].grade if sub.id in entry.results_dict else '-' }}</td>
                {% endfor %}

                {# Summary Totals #}
                <td class="summary-cell">{{ entry.total_points }}</td>
                <td class="summary-cell">{{ entry.total_subjects }}</td>
                <td class="summary-cell"><strong>{{ entry.final_grade }}</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>










